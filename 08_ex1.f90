!
!  SourceFile1.f90
!
!  Free-Format Fortran Source File 
!  Generated by PGI Visual Fortran(R)
!  2014-11-28 오후 12:51:34
!
PROGRAM EXONE
IMPLICIT NONE

REAL :: A,B,C,D,IM,B1,B2,B3,B4

PRINT*, "WRITE MATRIX ELEMENT A,B,C,D"
READ*,  A,B,C,D

IM = INMTRX(A,B,C,D)
 IF(IM==0) THEN
  STOP
  ELSE
  PRINT*, "MATRIX EXISTANT" 
  END IF
 
 CALL CAL_XY(A,B,C,D,B1,B2,B3,B4)
 PRINT*, B1,B2
 PRINT*, B3,B4

CONTAINS

 FUNCTION INMTRX(A1,A2,A3,A4)
  REAL :: INMTRX
  REAL, INTENT(IN) :: A1, A2, A3, A4
  INMTRX=(A1*A4)-(A2*A3)
 END FUNCTION INMTRX
 
 SUBROUTINE CAL_XY(A,B,C,D,B1,B2,B3,B4)
  REAL, INTENT(IN) :: A,B,C,D
  REAL, INTENT(OUT) :: B1,B2,B3,B4
  B1=D/((A*D)-(B*C))
  B2=-1*B/((A*D)-(B*C))
  B3=-1*C/((A*D)-(B*C))
  B4=A/((A*D)-(B*C))
  END SUBROUTINE CAL_XY
 
 END PROGRAM EXONE